---
import Layout from "../layouts/Layout.astro";
import { wpquery } from "../data/wordpress";
import BodyCopy from "../components/BodyCopy.astro";
import LowerContent from "../components/LowerContent.astro";
import LearnMoreList from "../components/LearnMoreList.astro";

export async function getStaticPaths() {
  const data = await wpquery({
    query: ` query ProgramsListing {
              programs {
                nodes {
                  program {
                    degreeType
                    slug
                    school
                    programOptions
                    additionalOptions
                    programAtAGlance
                    department {
                        deptTitle
                        deptUrl
                    }
                    careers{
                        left
                        right
                        body
                    }
                    programOfStudy{
                      left
                      right
                      body
                    }
                    lowerContent{
                      title
                      body
                    }
                    learnMoreList {
                      title
                      slug
                    }
                  }
                  title
                }
              }
            }`,
  });
  const paths = data.programs.nodes.map(
    (program: {
      program: {
        title: string;
        programAtAGlance: string;
        degreeType: string;
        school: string;
        department: string;
        careers: string;
        programOfStudy: string;
        lowerContent: [];
        learnMoreList: [];
        slug: string;
      };
      title: string;
    }) => ({
      params: { slug: program.program.slug },
      props: {
        slug: program.program.slug,
        title: program.title,
        programAtAGlance: program.program.programAtAGlance,

        degreeType: program.program.degreeType,
        school: program.program.school,
        department: program.program.department,
        careers: program.program.careers,
        programOfStudy: program.program.programOfStudy,
        lowerContent: program.program.lowerContent,
        learnMoreList: program.program.learnMoreList,
      },
    })
  );
  return paths;
}
const {
  title,
  body,
  slug,
  programAtAGlance,
  degreeType,
  school,
  department: { deptUrl, deptTitle },
  content,
  careers: { left: careersLeft, right: careersRight, body: careersBody },
  programOfStudy: {
    left: programOfStudyLeft,
    right: programOfStudyRight,
    body: programOfStudyBody,
  },
  lowerContent,
  learnMoreList,
} = Astro.props;
// console.log(typeof lowerContent);
---

<Layout title={title}>
  <main class="font-bitter text-darkgrey">
    <div class="bg-lightgrey w-auto">
      <div class="max-w-[70.5rem] m-auto">
        <h1
          class="font-chunkfive text-tcnjyellow text-custom-16.25 leading-[4.688rem]"
        >
          {title}
        </h1>

        <div id="degree-school-department" class="flex">
          <div>
            <h3>Degree</h3>
            <p>{degreeType} in {title}</p>
          </div>
          <div>
            <h3>School</h3>
            <p set:html={school} />
          </div>

          <div>
            <h3>Department</h3>
            <p>
              <a href={deptUrl}>
                {deptTitle}
              </a>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="bg-tcnjyellow w-auto">
      <div class="max-w-[70.5rem] m-auto">
        <div id="program-at-a-glance">
          <h2
            class="text-[4.375rem] font-chunkfive leading-[5rem] text-tcnjblue"
          >
            Program at a Glance
          </h2>
          <div set:html={programAtAGlance} />
        </div>
        <BodyCopy
          heading="Careers"
          left={careersLeft}
          right={careersRight}
          body={careersBody}
        />
        <BodyCopy
          heading="Programs of Study"
          left={programOfStudyLeft}
          right={programOfStudyRight}
          body={programOfStudyBody}
        />
      </div>
    </div>
    {lowerContent && <LowerContent lowerContent={lowerContent} />}
    {learnMoreList && <LearnMoreList learnMoreList={learnMoreList} />}
  </main>
</Layout>
